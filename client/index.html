<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <title>Twaat app</title>

    </script>
  </head>
  <body>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <h1 class="text-center">Twaat App</h1>
    <br><br>
    <form  action="#"  class="search">
      <div class="form-group container">
        <input type="text" id ="search"  placeholder="Your Search" class="form-control">
        <button type="submit" name="button" class="btn">Search</button>
      </div>
    </form>

    <form action="#" class="tweet">
      <div class="container form-group ">
        <input id ="tweet" type="text" name="newTweet" placeholder="New tweet" class="form-control">
        <button type="submit" name="button" class="btn" >Tweet</button>
      </div>

    </form>
    <br>
    <div class="container">
      <button type="button" name="button" onclick="getTimeline()" class="btn container btn-primary">Timeline</button>
    </div>

    <br><br>
    <div class="container" >
        <ol>

        </ol>
    </div>
    <script>
      function getTimeline() {
        axios.get('http://localhost:3000/timeline')
        .then(response=>{
          $("ol").html('')
          response.data.forEach(dataTweet=>{
            $("ol").append(
              `<div class="panel panel-primary">
                <div class="panel-heading">${dataTweet.user.name}</div>
                <div class="panel-body"> ${dataTweet.text}</div>
                <div class="panel-footer">${dataTweet.created_at}</div>
              </div>`)
          })
        })
        .catch(err=>{
          console.log(err);
        })
      }
      $("form.tweet").submit(evetHandler=>{
        var valueTweet = $("#tweet").val()
        console.log(valueTweet);
        evetHandler.preventDefault()
        axios.post('http://localhost:3000/newTweet',{
          tweet : valueTweet
        }).
        then(data =>{
          getTimeline()
        }).catch(err=>{console.log(err);})
      })

      $("form.search").submit(evetHandler =>{
        var searchValue = $("#search").val()
        console.log(searchValue);
        evetHandler.preventDefault()
        axios.post('http://localhost:3000/search',{
          search : searchValue
        }).
        then(show =>{
          $("ol").html('')
          show.data.forEach(dataSearch=>{
            $("ol").append(`<div class="panel panel-primary">
              <div class="panel-heading">${dataSearch.screen_name}</div>
              <div class="panel-body"> ${dataSearch.status.text}</div>
              <div class="panel-footer">${dataSearch.created_at}</div>
            </div>`)

          })
        }).catch(err=>(console.log(err)))
      })


    </script>



  </body>
</html>
